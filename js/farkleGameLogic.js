function FarkleDice(e,i,a,t){this.value=e,this.scored=i,this.saved=a,this.index=t,this.reset=function(){this.value=0,this.scored=0,this.saved=0,this.tempScored=0,DrawDice(this),this.ImageObj.removeAttribute("scored"),this.ImageObj.removeAttribute("rolling"),this.ImageObj.removeAttribute("saved"),this.ImageObj.style.display="inline"}}function loadImage(e,i){var a=new Image;return a.src=e,a}function farkleInit(e){var i;for(e||(e="dicebackSet6.png"),gDiceBackImage=loadImage("/images/"+e,0),i=0;MAX_DICE+1>=i;i++)gDiceImages[i]=loadImage("/images/diceFront"+i+".png",0);for(gDiceImageJoker=loadImage("/images/diceFrontJoker.png",0),i=0;MAX_DICE>=i;i++)newDice=new FarkleDice("0","0","0",i),dice[i]=newDice,dice[i].ImageObj=document.getElementById("dice"+i+"Canvas"),DrawDice(newDice);FarkleDiceReset(),$("#divRemind").hide(),lblRoundInfoObj=document.getElementById("lblRoundScore"),btnRollDiceObj=document.getElementById("btnRollDice"),btnPassObj=document.getElementById("btnPass"),divTurnActionObj=document.getElementById("divTurnAction"),divGameInfoObj=document.getElementById("divGameInfo")}function FarkleCalcRoll(){return Math.floor(6*Math.random())+1}function DrawDice(e){var i=document.getElementById("dice"+e.index+"Canvas"),a=i.getContext("2d");i.position;1==e.scored?a.drawImage(gDiceBackImage,0,240,120,120,0,0,60,60):1==e.saved?a.drawImage(gDiceBackImage,0,120,120,120,0,0,60,60):a.drawImage(gDiceBackImage,0,0,120,120,0,0,60,60),a.drawImage(gDiceImages[e.value],0,0,60,60),e.saved||e.scored?$("#dice"+e.index+"Canvas").css("margin","60px 1px 1px 1px"):$("#dice"+e.index+"Canvas").css("margin","1px 1px 60px 1px")}function FarkleDiceReset(){var e;for(e=0;MAX_DICE>=e;e++)dice[e].reset()}function farkleScoreDice(e){var i,a,t=0,c=0,d=0,r=0,n=0,o=0,s=0,m=Array(0,0,0,0,0,0);for(i=0;MAX_DICE>=i;i++)if(dice[i].saved&&!dice[i].scored){var g=0;for(a=0;MAX_DICE>=a;a++)dice[i].value==dice[a].value&&1==dice[a].saved&&0==m[a]&&0==dice[a].scored&&g++;1==g&&c++,1==dice[i].value?t+=3>g?100*g:1e3*(g-2):5==dice[i].value?t+=3>g?50*g:500*(g-2):3>g?0==m[i]&&(n=1):t+=100*dice[i].value*(g-2);var l=g/2;for((2==g||4==g||6==g)&&(d+=g/2),(3==g||6==g)&&(r+=g/3),(2==o&&1==l||1==o&&2==l)&&(s=1),o=d,a=0;MAX_DICE>=a;a++)dice[i].value==dice[a].value&&1==dice[a].saved&&0==m[a]&&0==dice[a].scored&&(m[a]=1)}return(3==d&&750>t||1==s)&&(750>t&&(t=750),n=0),6==c&&1e3>t&&(t=1e3,n=0),2==r&&2500>t&&(t=2500,n=0),n&&(t=0),t}function farkleUpdateDice(e,i,a){dice[e].ImageObj.removeAttribute("disabled"),i>0&&7>i&&(dice[e].ImageObj.removeAttribute("disabled"),dice[e].value=i),a?(dice[e].ImageObj.removeAttribute("saved"),dice[e].ImageObj.setAttribute("scored",""),dice[e].scored=1):(dice[e].ImageObj.removeAttribute("scored"),dice[e].scored=0),DrawDice(dice[e])}function farkleSaveDice(e,i){if(gGameState!=GAME_STATE_ROLLING&&gGameState!=GAME_STATE_ROLLED)return ConsoleDebug("Not allowing a dice save because we aren't in a state that can do so. Game state="+gGameState),0;0==dice[e].scored&&(0==dice[e].saved||i?(dice[e].ImageObj.removeAttribute("rolled"),dice[e].ImageObj.setAttribute("saved",""),dice[e].saved=1):(dice[e].ImageObj.removeAttribute("saved"),dice[e].ImageObj.setAttribute("rolled",""),dice[e].saved=0)),DrawDice(dice[e]);gTurnScore;gTurnScore=farkleScoreDice(0),lblRoundInfoObj.innerHTML=gRoundScore+gTurnScore}function StopRollingAnimation(){var e;for(e=0;MAX_DICE>=e;e++)dice[e].saved||dice[e].scored||dice[e].ImageObj.removeAttribute("rolling")}function GetDiceValArray(){var e,i=Array(0,0,0,0,0,0);for(e=0;MAX_DICE>=e;e++)i[e]=dice[e].saved?parseInt(dice[e].value):0,i[e]=dice[e].scored?10:i[e];return i}var gDiceBackImage,gDiceImages=Array(MAX_DICE),gDiceImageJoker,MAX_DICE=5,dice=new Array(MAX_DICE);
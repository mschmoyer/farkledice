function FarkleDice(e,t,n,r){this.value=e;this.scored=t;this.saved=n;this.index=r;this.reset=function(){this.value=0;this.scored=0;this.saved=0;this.tempScored=0;DrawDice(this);this.ImageObj.removeAttribute("scored");this.ImageObj.removeAttribute("rolling");this.ImageObj.removeAttribute("saved");this.ImageObj.style.display="inline"}}function loadImage(e,t){var n=new Image;n.src=e;return n}function farkleInit(){var e;var t=6;gDiceBackImage=loadImage("/images/dicebackSet"+t+".png",0);for(e=0;e<=MAX_DICE+1;e++){gDiceImages[e]=loadImage("/images/diceFront"+e+".png",0)}gDiceImageJoker=loadImage("/images/diceFrontJoker.png",0);for(e=0;e<=MAX_DICE;e++){newDice=new FarkleDice("0","0","0",e);dice[e]=newDice;dice[e].ImageObj=document.getElementById("dice"+e+"Canvas");DrawDice(newDice)}FarkleDiceReset();$("#divRemind").hide();lblRoundInfoObj=document.getElementById("lblRoundScore");btnRollDiceObj=document.getElementById("btnRollDice");btnPassObj=document.getElementById("btnPass");divTurnActionObj=document.getElementById("divTurnAction");divGameInfoObj=document.getElementById("divGameInfo")}function FarkleCalcRoll(){return Math.floor(Math.random()*6)+1}function DrawDice(e){var t=document.getElementById("dice"+e.index+"Canvas");var n=t.getContext("2d");var r=t.position;if(e.scored==1){n.drawImage(gDiceBackImage,0,240,120,120,0,0,60,60)}else if(e.saved==1){n.drawImage(gDiceBackImage,0,120,120,120,0,0,60,60)}else{n.drawImage(gDiceBackImage,0,0,120,120,0,0,60,60)}n.drawImage(gDiceImages[e.value],0,0,60,60);if(e.saved||e.scored){$("#dice"+e.index+"Canvas").css("margin","60px 1px 1px 1px")}else{$("#dice"+e.index+"Canvas").css("margin","1px 1px 60px 1px")}}function FarkleDiceReset(){var e;for(e=0;e<=MAX_DICE;e++)dice[e].reset()}function farkleScoreDice(e){var t=0;var n=0;var r;var i;var s=0;var o=0;var u=0;var a=0;var f=0;var l=0;var c=Array(0,0,0,0,0,0);for(r=0;r<=MAX_DICE;r++){if(!dice[r].saved||dice[r].scored)continue;var h=0;for(i=0;i<=MAX_DICE;i++){if(dice[r].value==dice[i].value&&dice[i].saved==1&&c[i]==0&&dice[i].scored==0){h++}}if(h==1)n++;if(dice[r].value==1){if(h<3){t+=h*100}else{t+=1e3*(h-2)}}else if(dice[r].value==5){if(h<3){t+=h*50}else{t+=500*(h-2)}}else{if(h<3){if(c[r]==0)u=1}else{t+=dice[r].value*100*(h-2)}}var p=h/2;if(h==2||h==4||h==6)s+=h/2;if(h==3||h==6)o+=h/3;if(a==2&&p==1||a==1&&p==2){f=1}a=s;for(i=0;i<=MAX_DICE;i++){if(dice[r].value==dice[i].value&&dice[i].saved==1&&c[i]==0&&dice[i].scored==0){c[i]=1}}}if(s==3&&t<750||f==1){if(t<750)t=750;u=0}if(n==6&&t<1e3){t=1e3;u=0}if(o==2&&t<2500){t=2500;u=0}if(u)t=0;return t}function farkleUpdateDice(e,t,n){dice[e].ImageObj.removeAttribute("disabled");if(t>0&&t<7){dice[e].ImageObj.removeAttribute("disabled");dice[e].value=t}if(n){dice[e].ImageObj.removeAttribute("saved");dice[e].ImageObj.setAttribute("scored","");dice[e].scored=1}else{dice[e].ImageObj.removeAttribute("scored");dice[e].scored=0}DrawDice(dice[e])}function farkleSaveDice(e,t){if(gGameState!=GAME_STATE_ROLLING&&gGameState!=GAME_STATE_ROLLED){ConsoleDebug("Not allowing a dice save because we aren't in a state that can do so. Game state="+gGameState);return 0}if(dice[e].scored==0){if(dice[e].saved==0||t){dice[e].ImageObj.removeAttribute("rolled");dice[e].ImageObj.setAttribute("saved","");dice[e].saved=1}else{dice[e].ImageObj.removeAttribute("saved");dice[e].ImageObj.setAttribute("rolled","");dice[e].saved=0}}DrawDice(dice[e]);var n=gTurnScore;gTurnScore=farkleScoreDice(0);lblRoundInfoObj.innerHTML=gRoundScore+gTurnScore}function StopRollingAnimation(){var e;for(e=0;e<=MAX_DICE;e++){if(!dice[e].saved&&!dice[e].scored){dice[e].ImageObj.removeAttribute("rolling")}}}function GetDiceValArray(){var e=Array(0,0,0,0,0,0);var t;for(t=0;t<=MAX_DICE;t++){e[t]=dice[t].saved?parseInt(dice[t].value):0;e[t]=dice[t].scored?10:e[t]}return e}var gDiceBackImage;var gDiceImages=Array(MAX_DICE);var gDiceImageJoker;var MAX_DICE=5;var dice=new Array(MAX_DICE)